!function e(t,r,i){function n(o,s){if(!r[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=r[o]={exports:{}};t[o][0].call(h.exports,function(e){var r=t[o][1][e];return n(r?r:e)},h,h.exports,e,t,r,i)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=e("./tools"),o=e("./gl"),s=function(){function e(t){function r(){m.setMouse(d),m.render(),window.requestAnimationFrame(r)}i(this,e),this.canvas=t,this.gl=void 0,this.program=void 0,this.uniforms={},this.vbo={},this.isValid=!1;var n=(0,o.setupWebGL)(t);if(n){this.gl=n,this.timeLoad=Date.now();var s="";if(t.hasAttribute("data-fragment"))s=t.getAttribute("data-fragment");else if(t.hasAttribute("data-fragment-url")){var u=t.getAttribute("data-fragment-url");s=(0,a.fetchHTTP)(u)}var l=void 0;if(t.hasAttribute("data-vertex"))l=t.getAttribute("data-vertex");else if(t.hasAttribute("data-vertex-url")){var u=t.getAttribute("data-vertex-url");l=(0,a.fetchHTTP)(u)}if(this.load(s,l),this.program){var h=n.getAttribLocation(this.program,"a_texcoord");this.vbo.texCoords=n.createBuffer(),this.gl.bindBuffer(n.ARRAY_BUFFER,this.vbo.texCoords),this.gl.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),n.STATIC_DRAW),this.gl.enableVertexAttribArray(h),this.gl.vertexAttribPointer(h,2,n.FLOAT,!1,0,0);var g=n.getAttribLocation(this.program,"a_position");this.vbo.vertices=n.createBuffer(),this.gl.bindBuffer(n.ARRAY_BUFFER,this.vbo.vertices),this.gl.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),n.STATIC_DRAW),this.gl.enableVertexAttribArray(g),this.gl.vertexAttribPointer(g,2,n.FLOAT,!1,0,0),this.textures={};var f=t.hasAttribute("data-textures");if(f){var c=t.getAttribute("data-textures").split(",");for(var v in c)this.loadTexture("u_tex"+v,c[v])}this.setMouse({x:0,y:0}),this.render(!0),this.canvas.addEventListener("resize",this.onResize);var d={x:0,y:0};document.addEventListener("mousemove",function(e){d.x=e.clientX||e.pageX,d.y=e.clientY||e.pageY},!1);var m=this;r()}}}return n(e,[{key:"destroy",value:function(){this.animated=!1,this.isValid=!1;for(var e in this.textures)this.gl.deleteTexture(e);this.textures={};for(var t in this.attribs)this.gl.deleteBuffer(this.attribs[t]);this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.program=null,this.gl=null}},{key:"load",value:function(e,t){t||(t="\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform vec2 u_resolution;\nuniform float u_time;\n\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\n\nvarying vec2 v_texcoord;\n\nvoid main() {\n    gl_Position = vec4(a_position, 0.0, 1.0);\n    v_texcoord = a_texcoord;\n}\n"),e||(e="\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform vec2 u_resolution;\nuniform float u_time;\n\nvarying vec2 v_texcoord;\n\nvoid main(){\n    vec2 st = gl_FragCoord.xy/u_resolution;\n    gl_FragColor = vec4(st.x,st.y,abs(sin(u_time)),1.0);\n}\n"),this.vertexString=t,this.fragmentString=e,this.animated=!1;var r=(e.match(/u_time/g)||[]).length,i=(e.match(/u_mouse/g)||[]).length;this.animated=r>1||i>1;var n=(0,o.createShader)(this.gl,t,this.gl.VERTEX_SHADER),a=(0,o.createShader)(this.gl,e,this.gl.FRAGMENT_SHADER);a?this.isValid=!0:(a=(0,o.createShader)(this.gl,"void main(){\n	gl_FragColor = vec4(1.0);\n}",this.gl.FRAGMENT_SHADER),this.isValid=!1);var s=(0,o.createProgram)(this.gl,[n,a]);this.gl.useProgram(s),this.gl.deleteShader(n),this.gl.deleteShader(a),this.program=s,this.change=!0,this.render(!0)}},{key:"loadTexture",value:function(e,t){var r=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array([255,255,0,255])),r.image=new Image,r.image.onload=function(e,t){return function(){(0,o.loadTexture)(e.gl,t),e.render(!0)}}(this,r),r.name=e,r.url=t,r.image.src=t,this.textures[e]=r}},{key:"refreshUniforms",value:function(){this.uniforms={}}},{key:"setUniform",value:function(e){for(var t={},r=arguments.length,i=Array(r>1?r-1:0),n=1;r>n;n++)i[n-1]=arguments[n];t[e]=i,this.setUniforms(t)}},{key:"setUniforms",value:function(e){var t=(0,o.parseUniforms)(e);for(var r in t)"sampler2D"===t[r].type?this.setTextureUniform(t[r].name,t[r].value[0]):this.uniform(t[r].method,t[r].type,t[r].name,t[r].value)}},{key:"uniform",value:function t(e,r,i){this.uniforms[i]=this.uniforms[i]||{};for(var t=this.uniforms[i],n=arguments.length,o=Array(n>3?n-3:0),s=3;n>s;s++)o[s-3]=arguments[s];var u=(0,a.isDiff)(t.value,o);(u||this.change||void 0===t.location||void 0===t.value)&&(t.name=i,t.value=o,t.type=r,t.method="uniform"+e,t.location=this.gl.getUniformLocation(this.program,i),this.gl[t.method].apply(this.gl,[t.location].concat(t.value)))}},{key:"setTextureUniform",value:function(e,t){void 0===this.textures[e]?this.loadTexture(e,t):(this.uniform("1i","sampler2D",e,this.texureIndex),this.gl.activeTexture(this.gl.TEXTURE0+this.texureIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[e]),this.uniform("2f","vec2",e+"Resolution",this.textures[e].image.width,this.textures[e].image.height),this.texureIndex++)}},{key:"setMouse",value:function(e){var t=this.canvas.getBoundingClientRect();e&&e.x&&e.x>=t.left&&e.x<=t.right&&e.y&&e.y>=t.top&&e.y<=t.bottom&&this.uniform("2f","vec2","u_mouse",e.x-t.left,this.canvas.height-(e.y-t.top))}},{key:"onResize",value:function(){var e=window.devicePixelRatio||1,t=Math.floor(this.gl.canvas.clientWidth*e),r=Math.floor(this.gl.canvas.clientHeight*e);(this.gl.canvas.width!==t||this.gl.canvas.height!==r)&&(this.gl.canvas.width=t,this.gl.canvas.height=r,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height))}},{key:"render",value:function(e){if(void 0!==e&&e||this.animated&&(0,a.isCanvasVisible)(this.canvas)){var t=Date.now(),r=(t-this.timeLoad)/1e3;this.uniform("1f","float","u_time",r),this.uniform("2f","vec2","u_resolution",this.canvas.width,this.canvas.height),this.texureIndex=0;for(var i in this.textures)this.setUniform(i,this.textures[i].url);this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.change=!1}}},{key:"version",value:function(){return"0.0.1"}}]),e}();r["default"]=s,window.GlslCanvas=s,t.exports=r["default"]},{"./gl":2,"./tools":3}],2:[function(e,t,r){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function n(e,t){e.bindTexture(e.TEXTURE_2D,t),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.image),(0,g.isPowerOf2)(t.image.width)&&(0,g.isPowerOf2)(t.image.height)?(e.generateMipmap(e.TEXTURE_2D),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),e.bindTexture(e.TEXTURE_2D,null)}function a(e){return'\n<table style="background-color: #8CE; width: 100%; height: 100%;"><tr>\n<td align="center">\n<div style="display: table-cell; vertical-align: middle;">\n<div style="">'+e+"</div>\n</div>\n</td></tr></table>\n"}function o(e,t){function r(t){var r=e.parentNode;r&&(r.innerHTML=a(t))}if(!window.WebGLRenderingContext)return r(c),null;var i=s(e,t);return i||r(v),i.getExtension("OES_standard_derivatives"),i}function s(e,t){for(var r=["webgl","experimental-webgl"],i=null,n=0;n<r.length;++n)try{i=e.getContext(r[n],t)}catch(a){if(i)break}return i}function u(e,t,r){var i=e.createShader(r);e.shaderSource(i,t),e.compileShader(i);var n=e.getShaderParameter(i,e.COMPILE_STATUS);return n?i:(f=e.getShaderInfoLog(i),console.error("*** Error compiling shader "+i+":"+f),e.deleteShader(i),null)}function l(e,t,r,i){for(var n=e.createProgram(),a=0;a<t.length;++a)e.attachShader(n,t[a]);if(r)for(var a=0;a<r.length;++a)e.bindAttribLocation(n,i?i[a]:a,r[a]);e.linkProgram(n);var o=e.getProgramParameter(n,e.LINK_STATUS);return o?n:(f=e.getProgramInfoLog(n),console.log("Error in program linking:"+f),e.deleteProgram(n),null)}function h(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],r=[];for(var n in e){var a=e[n],o=void 0;if(t&&(n=t+"."+n),"number"==typeof a)r.push({type:"float",method:"1f",name:n,value:a});else if(Array.isArray(a)){if("number"==typeof a[0])a.length>=2&&a.length<=4?r.push({type:"vec"+a.length,method:a.length+"fv",name:n,value:a}):a.length>4&&r.push({type:"float[]",method:"1fv",name:n+"[0]",value:a});else if("string"==typeof a[0])r.push({type:"sampler2D",method:"1i",name:n,value:a});else if(Array.isArray(a[0])&&"number"==typeof a[0][0]){if(a[0].length>=2&&a[0].length<=4)for(o=0;o<a.length;o++)r.push({type:"vec"+a[0].length,method:a[o].length+"fv",name:n+"["+o+"]",value:a[o]})}else if("object"==typeof a[0])for(o=0;o<a.length;o++)r.push.apply(r,i(h(a[o],n+"["+o+"]")))}else"boolean"==typeof a?r.push({type:"bool",method:"1i",name:n,value:a}):"string"==typeof a?r.push({type:"sampler2D",method:"1i",name:n,value:a}):"object"==typeof a&&r.push.apply(r,i(h(a,n)))}return r}Object.defineProperty(r,"__esModule",{value:!0}),r.loadTexture=n,r.setupWebGL=o,r.create3DContext=s,r.createShader=u,r.createProgram=l,r.parseUniforms=h;var g=e("./tools"),f="",c='\n	This page requires a browser that supports WebGL.<br/>\n	<a href="http://get.webgl.org">Click here to upgrade your browser.</a>\n',v='\n	It does not appear your computer can support WebGL.<br/>\n	<a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>\n'},{"./tools":3}],3:[function(e,t,r){"use strict";function i(e){return e.getBoundingClientRect().top+e.height>0&&e.getBoundingClientRect().top<(window.innerHeight||document.documentElement.clientHeight)}function n(e){return 0===(e&e-1)}function a(e){--e;for(var t=1;32>t;t<<=1)e|=e>>t;return e+1}function o(e,t){var r=new XMLHttpRequest,i=void 0;return r.onreadystatechange=function(){4===r.readyState&&200===r.status&&(i=r.responseText)},r.open(t?t:"GET",e,!1),r.overrideMimeType("text/plain"),r.send(),i}function s(e,t){for(var r=e.toString();r.length<t;)r="0"+r;return r}function u(e,t){var r=e.getBoundingClientRect();return{x:t.clientX-r.left,y:t.clientY-r.top}}function l(e,t){return e&&t?e.toString()!==t.toString():!1}Object.defineProperty(r,"__esModule",{value:!0}),r.isCanvasVisible=i,r.isPowerOf2=n,r.nextHighestPowerOfTwo=a,r.fetchHTTP=o,r.FormatNumberLength=s,r.getMousePos=u,r.isDiff=l},{}]},{},[1]);
//# sourceMappingURL=GlslCanvas.min.js.map
